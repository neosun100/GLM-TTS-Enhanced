# GLM-TTS v1.2.0 - 基于all-in-one-v2增量更新
FROM neosun/glm-tts:all-in-one-v2

WORKDIR /app

# 复制v1.2.0新增模块
COPY emotion_control.py ./
COPY streaming_engine.py ./
COPY emotion_streaming_api.py ./
COPY server.py ./

# 标签
LABEL version="1.2.0"
LABEL description="GLM-TTS with emotion control and streaming inference"
LABEL features="emotion-control,streaming,voice-cache"

# 健康检查
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:8080/health || exit 1

CMD ["python3", "server.py"]
