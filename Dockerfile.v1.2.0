# GLM-TTS v1.2.0 - 基于all-in-one-v2，仅包含Voice Cache功能
FROM neosun/glm-tts:all-in-one-v2

WORKDIR /app

# 复制更新的server.py（移除了不支持的情感控制UI）
COPY server.py ./

# 标签
LABEL version="1.2.0"
LABEL description="GLM-TTS with voice cache (emotion control removed - not supported by inference script)"
LABEL features="voice-cache,whisper-auto-transcribe"

# 健康检查
HEALTHCHECK --interval=30s --timeout=10s --start-period=60s --retries=3 \
    CMD curl -f http://localhost:8080/health || exit 1

CMD ["python3", "server.py"]
